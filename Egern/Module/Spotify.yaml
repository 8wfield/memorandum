name: Spotify去广告
description: 移除播放广告，恢复歌手和专辑列表的正常展示。
open_url: https://apps.apple.com/app/id324684580
author: 001ProMax[https://github.com/001ProMax]
compat_arguments:
  移除低栏创建按钮: '1'
  启用Apple设备接力: '#'
compat_arguments_desc: '将 # 改成任意名称即可开启对应脚本\n\n隐藏为:1/true  不隐藏为:0/false'
rules:
- and:
    match:
    - domain:
        match: spclient.wg.spotify.com
    - protocol:
        match: QUIC
    policy: REJECT
url_rewrites:
- match: ^https:\/\/spclient\.wg\.spotify\.com\/(artistview\/v1\/artist|album-entity-view\/v2\/album)\/(.*)platform=iphone
  location: https://spclient.wg.spotify.com/$1/$2platform=ipad
  status_code: 307
map_locals:
- match: ^https:\/\/spclient\.wg\.spotify\.com\/pendragon\/
  status_code: 200
  headers:
    Content-Type: application/json
  body: '{}'
scriptings:
- http_response:
    name: Protobuf处理
    match: ^https:\/\/spclient\.wg\.spotify\.com\/(?:bootstrap|user-customization-service)
    script_url: https://kelee.one/Resource/Script/Spotify/Spotify_remove_ads.js
    arguments:
      _compat.$argument: '[{tab},{useractivity}]'
    timeout: 10
    body_required: true
    binary_body: true
mitm:
  hostnames:
    includes:
    - spclient.wg.spotify.com