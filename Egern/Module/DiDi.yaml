name: 滴滴出行去广告
description: 过滤滴滴出行广告
author: ZenmoFeiShi[https://github.com/ZenmoFeiShi], 可莉🅥[https://github.com/luestr/ProxyResource/blob/main/README.md]
date: 2025-03-07 17:00

rules:
  - DOMAIN,hd.xiaojukeji.com,REJECT
  - DOMAIN,gwp.xiaojukeji.com,REJECT
  - AND,((IP-ASN,45090,no-resolve),(DEST-PORT,25641),(PROTOCOL,TCP)),REJECT
  - AND,((IP-ASN,63646,no-resolve),(DEST-PORT,25641),(PROTOCOL,TCP)),REJECT
  # - DOMAIN,img-ys011.didistatic.com,REJECT

url_rewrite:
  - pattern: ^https:\/\/res\.xiaojukeji\.com\/resapi\/activity\/getMulti\?
    rewrite: reject-dict
  - pattern: ^https:\/\/res\.xiaojukeji\.com\/resapi\/activity\/xpget
    rewrite: reject-dict
  - pattern: ^https:\/\/ct\.xiaojukeji\.com\/agent\/v3\/feeds
    rewrite: reject-dict
  - pattern: ^https:\/\/freight\.xiaojukeji\.com\/gateway
    rewrite: reject-dict
  - pattern: ^https:\/\/daijia\.kuaidadi\.com:443\/gateway
    rewrite: reject-dict
  - pattern: ^https:\/\/res\.xiaojukeji\.com\/resapi\/activity\/mget
    rewrite: reject-dict
  - pattern: ^https:\/\/conf\.diditaxi\.com\.cn\/homepage\/v[0-9]+\/other\/fast
    rewrite: reject-dict
  - pattern: ^https:\/\/conf\.diditaxi\.com\.cn\/dynamic\/conf
    rewrite: reject-dict
  - pattern: ^https:\/\/conf\.diditaxi\.com\.cn\/homepage\/v1\/other\/slow
    rewrite: reject-dict
  - pattern: ^https:\/\/common\.diditaxi\.com\.cn\/common\/v[0-9]+\/usercenter\/me
    rewrite: response-body-json-jq
    jq: ".data.cards |= map(select(.title != \"天天领福利\" and .title != \"金融服务\" and .title != \"更多服务\" and .title != \"企业服务\" and .title != \"安全中心\")) | .data.cards[] |= if .tag == \"wallet\" then .items |= map(select(.title == \"优惠券\")) | if .card_type == 4 then .bottom_items |= map(select(.title == \"省钱套餐\" or .title == \"出行里程\")) else . end else . end"
  - pattern: ^https:\/\/conf\.diditaxi\.com\.cn\/homepage\/v[0-9]+\/core
    rewrite: response-body-json-jq
    jq: ".data.order_cards.nav_list_card.data |= map(select(.nav_id == \"dache_anycar\" or .nav_id == \"driverservice\" or .nav_id == \"bike\" or .nav_id == \"carmate\")) | .data.disorder_cards.bottom_nav_list.data |= map(select(.id == \"v6x_home\" or .id == \"home_page\" or .id == \"user_center\"))"
  - pattern: ^https:\/\/api\.udache\.com\/gulfstream\/pre-sale\/v1\/other\/pGetSceneList
    rewrite: response-body-json-jq
    jq: ".data.scene_list |= map(select(.text != \"优惠商城\")) | .data.show_data[] |= (if .scene_ids then .scene_ids |= map(select(. != \"scene_coupon_mall\")) else . end)"
  - pattern: ^https:\/\/conf\.diditaxi\.com\.cn\/ota\/na\/yuantu\/infoList
    rewrite: response-body-json-jq
    jq: ".data.disorder_cards.top_banner_card.data |= if .[0].T == \"yuentu_top_banner\" then .[1:] else . end"
  - pattern: ^https:\/\/api\.udache\.com\/gulfstream\/passenger-center\/v2\/other\/pInTripLayout
    rewrite: response-body-json-jq
    jq: ".data.order_components |= map(select(.name != \"passenger_common_casper\"))"

scripts:
  - match: ^https:\/\/common\.diditaxi\.com\.cn\/common\/v[0-9]+\/usercenter\/me
    type: http-response
    script_path: https://raw.githubusercontent.com/ZenmoFeiShi/Qx/main/Didichuxing.js
    requires_body: true
    timeout: 10
    tag: 移除滴滴出行广告
  - match: ^https:\/\/conf\.diditaxi\.com\.cn\/homepage\/v[0-9]+\/core
    type: http-response
    script_path: https://raw.githubusercontent.com/ZenmoFeiShi/Qx/main/Didichuxing.js
    requires_body: true
    timeout: 10
    tag: 移除滴滴出行广告
  - match: ^https:\/\/api\.udache\.com\/gulfstream\/pre-sale\/v1\/other\/pGetSceneList
    type: http-response
    script_path: https://raw.githubusercontent.com/ZenmoFeiShi/Qx/main/Didichuxing.js
    requires_body: true
    timeout: 10
    tag: 移除滴滴出行广告
  - match: ^https:\/\/conf\.diditaxi\.com\.cn\/ota\/na\/yuantu\/infoList
    type: http-response
    script_path: https://raw.githubusercontent.com/ZenmoFeiShi/Qx/main/Didichuxing.js
    requires_body: true
    timeout: 10
    tag: 移除滴滴出行广告
  - match: ^https:\/\/api\.udache\.com\/gulfstream\/passenger-center\/v2\/other\/pInTripLayout
    type: http-response
    script_path: https://raw.githubusercontent.com/ZenmoFeiShi/Qx/main/Didichuxing.js
    requires_body: true
    timeout: 10
    tag: 移除滴滴出行广告
  - match: ^https:\/\/conf\.diditaxi\.com\.cn\/homepage\/v1\/oversea\/layout
    type: http-response
    script_path: https://raw.githubusercontent.com/ZenmoFeiShi/Qx/main/Didichuxing.js
    requires_body: true
    timeout: 10
    tag: 移除滴滴出行广告

mitm:
  hostnames:
    - common.diditaxi.com.cn
    - freight.xiaojukeji.com
    - daijia.kuaidadi.com
    - 162.14.157.*
    - ct.xiaojukeji.com
    - res.xiaojukeji.com
    - conf.diditaxi.com.cn
    - api.udache.com
    - 123.207.209.*
    - 120.241.142.*
    - 120.241.143.*
    - 116.85.*
    - 139.199.240.84